// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.20;

import "forge-std/Test.sol";
import "./PublicKeyChallenge.sol";

contract ExploitTest is Test {
    address playerAddr;
    PublicKeyChallenge challenge;

    function setUp() public {
        playerAddr = makeAddr("player");
        challenge = new PublicKeyChallenge();
        vm.deal(playerAddr, 1 ether);
    }

    function test() public {
        vm.startPrank(playerAddr, playerAddr);

        challenge.authenticate(hex"613a8d23bd34f7e568ef4eb1f68058e77620e40079e88f705dfb258d7a06a1a0364dbe56cab53faf26137bec044efd0b07eec8703ba4a31c588d9d94c35c8db4");

        vm.stopPrank();
        assertTrue(challenge.isComplete(), "Challenge is not complete");
    }
}
